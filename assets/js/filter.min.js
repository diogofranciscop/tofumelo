let originalOrder=[],selectedRoles=[],selectedDiets=[],searchTerm="",selectedTitleSort="",selectedTimeSort="";function reapplyFilters(){selectedRoles.length>0||selectedDiets.length>0||searchTerm||selectedTitleSort||selectedTimeSort?filterAndSortPosts():loadPage(0,originalOrder)}function resetFilters(){selectedRoles=[],selectedDiets=[],searchTerm="",selectedTitleSort="",selectedTimeSort="",$(".button-4").removeClass("selected"),$("#filterBox input[data-diet]").prop("checked",!1),$("#toggleOrdemAZ, #toggleOrdemZA, #toggleTempoMenor, #toggleTempoMaior").prop("checked",!1),$(".searchTerm").val(""),loadPage(0,originalOrder)}function loadOriginalPosts(){loadPage(0,originalOrder=JSON.parse(JSON.stringify(allPosts)))}function setupFilterButton(){$(".filter-button").on("click",function(e){e.stopPropagation(),$("#filterBox").toggle(),positionFilterBox(this)}),$(document).on("click",function(e){let t=$("#filterBox"),o=$(".filter-button");t.is(e.target)||0!==t.has(e.target).length||o.is(e.target)||t.hide()})}function positionFilterBox(e){let t=$(e).offset(),o=$(e).outerHeight();$("#filterBox").css({top:t.top+o+10+"px",left:t.left+"px",position:"absolute"})}function setupRoleSelection(){$(".button-4").on("click",function(){let e=$(this).data("role");toggleSelection(e,"role"),$(this).toggleClass("selected",selectedRoles.includes(e)),filterAndSortPosts()})}function setupDietSelection(){$("#filterBox input[data-diet]").on("change",function(){let e=$(this).data("diet")?$(this).data("diet"):"";toggleSelection(e,"diet"),filterAndSortPosts()})}function setupSorting(){$("#toggleOrdemAZ, #toggleOrdemZA, #toggleTempoMenor, #toggleTempoMaior").on("change",function(){let e=$(this).attr("id");$(this).is(":checked")?(selectedTitleSort="toggleOrdemAZ"===e||"toggleOrdemZA"===e?e:"",selectedTimeSort="toggleTempoMenor"===e||"toggleTempoMaior"===e?e:"",$('input[type="checkbox"][name="sort"]').not(this).prop("checked",!1)):"toggleOrdemAZ"===e||"toggleOrdemZA"===e?selectedTitleSort="":("toggleTempoMenor"===e||"toggleTempoMaior"===e)&&(selectedTimeSort=""),console.log("Selected Sorts:",selectedTitleSort,selectedTimeSort),filterAndSortPosts()})}function setupSearch(){$(".searchTerm").on("input",function(){searchTerm=$(this).val().toLowerCase(),filterAndSortPosts()})}function toggleSelection(e,t){let o="role"===t?selectedRoles:selectedDiets,l=o.indexOf(e);-1===l?o.push(e):o.splice(l,1)}function filterAndSortPosts(){let e=!selectedTitleSort&&!selectedTimeSort;if(console.log("No Sort Selected:",e),console.log("Selected Sorts:",selectedTitleSort,selectedTimeSort),e){console.log("Restoring Original Order");let t=originalOrder;(selectedRoles.length>0||selectedDiets.length>0||searchTerm)&&(t=t.filter(e=>{let t=0===selectedRoles.length||selectedRoles.some(t=>e.type.includes(t)),o=0===selectedDiets.length||selectedDiets.every(t=>e.diet.includes(t)),l=e.title.toLowerCase().includes(searchTerm);return t&&o&&l})),loadPage(0,t);return}let o=originalOrder.filter(e=>{let t=0===selectedRoles.length||selectedRoles.some(t=>e.type.includes(t)),o=0===selectedDiets.length||selectedDiets.every(t=>e.diet.includes(t)),l=e.title.toLowerCase().includes(searchTerm);return t&&o&&l});selectedTitleSort?o.sort((e,t)=>"toggleOrdemAZ"===selectedTitleSort?e.title.localeCompare(t.title):t.title.localeCompare(e.title)):selectedTimeSort&&o.sort((e,t)=>"toggleTempoMenor"===selectedTimeSort?parseInt(e.time)-parseInt(t.time):parseInt(t.time)-parseInt(e.time)),loadPage(0,o)}$(document).ready(function(){resetFilters(),loadOriginalPosts(),setupFilterButton(),setupRoleSelection(),setupDietSelection(),setupSorting(),setupSearch(),$(window).on("pageshow",function(){reapplyFilters()})});