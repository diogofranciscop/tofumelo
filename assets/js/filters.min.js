let originalOrder=[],filteredPosts=[],selectedRoles=[],selectedDiets=[],searchTerm="",selectedTitleSort="",selectedTimeSort="";function filterAndSortPosts(){filteredPosts=(filteredPosts=[...originalOrder]).filter(e=>{let t=0===selectedRoles.length||selectedRoles.some(t=>e.type.includes(t)),i=0===selectedDiets.length||selectedDiets.every(t=>e.diet.includes(t)),s=e.title.toLowerCase().includes(searchTerm);return t&&i&&s}),selectedTitleSort?filteredPosts.sort((e,t)=>"toggleOrdemAZ"===selectedTitleSort?e.title.localeCompare(t.title):t.title.localeCompare(e.title)):selectedTimeSort&&filteredPosts.sort((e,t)=>"toggleTempoMenor"===selectedTimeSort?parseInt(e.time)-parseInt(t.time):parseInt(t.time)-parseInt(e.time)),loadPaginatedPosts(1,filteredPosts)}function loadPaginatedPosts(e,t){let i=window.innerWidth<=768,s=i?10:20,o=(e-1)*s,l=t.slice(o,o+s),n=$("#post-container");n.empty(),l.forEach(e=>{let i=e.image.replace(/\.(webp|png|jpg|jpeg)$/,"-180px.$1"),s=`
    <a href="${e.url}" class="card" data-index="${t.indexOf(e)+1}">
     <div class="skeleton skeleton-card"></div>
        <div class="card__img-container">
            <img src="${i}" class="card__img" alt="${e.title}" style="display: none;">
        </div>
        ${"yes"===e.new?'<div class="new-tape" style="display:none">Nova Receita</div>':""}
        <div class="card__overlay"><p>${e.description}</p></div>
        <div class="card__footer">
            <span class="title-card" style="display: none;">${e.title.toUpperCase()}</span>
        </div>
    </a>
`;n.append(s);let o=n.find(`img[src="${i}"]`);o.on("load",function(){let e=$(this).closest(".card");e.find(".skeleton-card").addClass("hidden"),$(this).fadeIn(),e.find(".title-card").removeClass("hidden").fadeIn(),e.find(".new-tape").removeClass("hidden").fadeIn()})}),updatePaginationButtons(e,t.length,s),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},0)}function loadPosts(e){let t=window.innerWidth<=768,i=t?10:20,s=(e-1)*i,o=filteredPosts.slice(s,s+i),l=document.getElementById("post-container");l.innerHTML="",o.forEach(e=>{let t=`
    <a href="${e.url}" class="card">
     <div class="skeleton skeleton-card"></div> 
        ${"yes"===e.new?'<div class="new-tape">Nova Receita</div>':""}
        <div class="card__overlay"><p>${e.description}</p></div>
        <div class="card__img-container">
            <img src="${e.image}" class="card__img" alt="${e.title}">
        </div>
        <div class="card__footer">
            <span class="title-card">${e.title.toUpperCase()}</span>
        </div>
    </a>
`;l.insertAdjacentHTML("beforeend",t)}),updatePaginationButtons(e,filteredPosts.length,i)}function updatePaginationButtons(e,t,i){let s=Math.ceil(t/i),o=document.getElementById("pagination-container");o.innerHTML="";let l=document.createElement("button");l.textContent="PRIMEIRA P\xc1GINA",l.classList.add("pagination-button"),l.addEventListener("click",()=>{loadPaginatedPosts(1,filteredPosts)}),o.appendChild(l);for(let n=Math.max(1,e-2);n<=Math.min(s,e+2);n++){let a=document.createElement("button");a.textContent=n,a.classList.add("pagination-button"),n===e&&a.classList.add("active"),a.addEventListener("click",()=>{loadPaginatedPosts(n,filteredPosts)}),o.appendChild(a)}let d=document.createElement("button");d.textContent="\xdaLTIMA P\xc1GINA",d.classList.add("pagination-button"),d.addEventListener("click",()=>{loadPaginatedPosts(s,filteredPosts)}),o.appendChild(d)}function setupFilterButton(){$(".filter-button").on("click",function(e){e.stopPropagation(),$("#filterBox").toggle(),function e(t){let i=$(t).offset(),s=$(t).outerHeight();$("#filterBox").css({top:i.top+s+10+"px",left:i.left+"px",position:"absolute"})}(this)}),$(document).on("click",function(e){let t=$("#filterBox"),i=$(".filter-button");t.is(e.target)||0!==t.has(e.target).length||i.is(e.target)||t.hide()})}function setupRoleSelection(){$(".button-4").on("click",function(){let e=$(this).data("role");toggleSelection(e,"role"),$(this).toggleClass("selected",selectedRoles.includes(e)),filterAndSortPosts()})}function setupDietSelection(){$("#filterBox input[data-diet]").on("change",function(){let e=$(this).data("diet")||"";toggleSelection(e,"diet"),filterAndSortPosts()})}function setupSorting(){$('input[type="checkbox"][name="sort"]').on("change",function(){let e=$(this).attr("id");$(this).is(":checked")?(selectedTitleSort=e.startsWith("toggleOrdem")?e:"",selectedTimeSort=e.startsWith("toggleTempo")?e:"",$('input[type="checkbox"][name="sort"]').not(this).prop("checked",!1)):"toggleOrdemAZ"===e||"toggleOrdemZA"===e?selectedTitleSort="":("toggleTempoMenor"===e||"toggleTempoMaior"===e)&&(selectedTimeSort=""),filterAndSortPosts()})}function setupSearch(){$(".searchTerm").on("input",function(){searchTerm=$(this).val().toLowerCase(),filterAndSortPosts()})}function toggleSelection(e,t){let i="role"===t?selectedRoles:selectedDiets,s=i.indexOf(e);-1===s?i.push(e):i.splice(s,1)}$(document).ready(function(){filteredPosts=[...originalOrder=JSON.parse(JSON.stringify(allPosts))],setupFilterButton(),setupRoleSelection(),setupDietSelection(),setupSorting(),setupSearch(),loadPaginatedPosts(1,filteredPosts)}),window.addEventListener("resize",()=>{window.innerWidth,loadPaginatedPosts(1,filteredPosts)});