let originalOrder=[],filteredPosts=[],selectedRoles=[],selectedDiets=[],searchTerm="",selectedTitleSort="",selectedTimeSort="";window.paginationTriggered=!1,$(document).ready(function(){filteredPosts=[...originalOrder=JSON.parse(JSON.stringify(allPosts))],setupFilterButton(),setupRoleSelection(),setupDietSelection(),setupSorting(),setupSearch(),loadPaginatedPosts(1,filteredPosts)});let previousIsMobile=window.innerWidth<=768;function filterAndSortPosts(){filteredPosts=(filteredPosts=[...originalOrder]).filter(e=>{let t=0===selectedRoles.length||selectedRoles.some(t=>e.type.includes(t)),i=0===selectedDiets.length||selectedDiets.every(t=>e.diet.includes(t)),o=e.title.toLowerCase().includes(searchTerm);return t&&i&&o}),selectedTitleSort?filteredPosts.sort((e,t)=>"toggleOrdemAZ"===selectedTitleSort?e.title.localeCompare(t.title):t.title.localeCompare(e.title)):selectedTimeSort&&filteredPosts.sort((e,t)=>"toggleTempoMenor"===selectedTimeSort?parseInt(e.time)-parseInt(t.time):parseInt(t.time)-parseInt(e.time)),loadPaginatedPosts(1,filteredPosts)}function loadPaginatedPosts(e,t){let i=window.innerWidth<=768,o=i?10:20,s=(e-1)*o,n=$("#post-container");if(1===e&&!window.firstPageNavigated){window.firstPageNavigated=!0,updatePaginationButtons(e,t.length,o);return}n.empty();let l=t.slice(s,s+o);l.forEach(e=>{let i=e.image.replace(/\.(webp|png|jpg|jpeg)$/,"-180px.$1"),o=`
    <a href="${e.url}" class="card" data-index="${t.indexOf(e)+1}">
        <div class="skeleton skeleton-card"></div>
        <div class="card__img-container">
            <img src="${i}" class="card__img" alt="${e.title}" style="display: none;">
        </div>
        ${"yes"===e.new?'<div class="new-tape" style="display:none">Nova Receita</div>':""}
        <div class="card__overlay"><p>${e.description}</p></div>
        <div class="card__footer">
            <span class="title-card" style="display: none;">${e.title.toUpperCase()}</span>
        </div>
    </a>
`;n.append(o);let s=n.find(`img[src="${i}"]`);s.on("load",function(){let e=$(this).closest(".card");e.find(".skeleton-card").addClass("hidden"),$(this).fadeIn(),e.find(".title-card").removeClass("hidden").fadeIn(),e.find(".new-tape").removeClass("hidden").fadeIn()})}),updatePaginationButtons(e,t.length,o),window.paginationTriggered&&setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"}),window.paginationTriggered=!1},0)}function updatePaginationButtons(e,t,i){let o=Math.ceil(t/i),s=document.getElementById("pagination-container");s.innerHTML="";let n=document.createElement("button");n.textContent="PRIMEIRA P\xc1GINA",n.classList.add("pagination-button"),n.disabled=1===e,n.addEventListener("click",()=>{window.paginationTriggered=!0,loadPaginatedPosts(1,filteredPosts)}),s.appendChild(n);for(let l=Math.max(1,e-2);l<=Math.min(o,e+2);l++){let a=document.createElement("button");a.textContent=l,a.classList.add("pagination-button"),l===e&&a.classList.add("active"),a.addEventListener("click",()=>{window.paginationTriggered=!0,l!==e&&loadPaginatedPosts(l,filteredPosts)}),s.appendChild(a)}let d=document.createElement("button");d.textContent="\xdaLTIMA P\xc1GINA",d.classList.add("pagination-button"),d.disabled=e===o,d.addEventListener("click",()=>{window.paginationTriggered=!0,loadPaginatedPosts(o,filteredPosts)}),s.appendChild(d)}function setupFilterButton(){$(".filter-button").on("click",function(e){e.stopPropagation(),$("#filterBox").toggle(),function e(t){let i=$(t).offset(),o=$(t).outerHeight();$("#filterBox").css({top:i.top+o+10+"px",left:i.left+"px",position:"absolute"})}(this)}),$(document).on("click",function(e){let t=$("#filterBox"),i=$(".filter-button");t.is(e.target)||0!==t.has(e.target).length||i.is(e.target)||t.hide()})}function setupRoleSelection(){$(".button-4").on("click",function(){let e=$(this).data("role");toggleSelection(e,"role"),$(this).toggleClass("selected",selectedRoles.includes(e)),filterAndSortPosts()})}function setupDietSelection(){$("#filterBox input[data-diet]").on("change",function(){let e=$(this).data("diet")||"";toggleSelection(e,"diet"),filterAndSortPosts()})}function setupSorting(){$('input[type="checkbox"][name="sort"]').on("change",function(){let e=$(this).attr("id");$(this).is(":checked")?(selectedTitleSort=e.startsWith("toggleOrdem")?e:"",selectedTimeSort=e.startsWith("toggleTempo")?e:"",$('input[type="checkbox"][name="sort"]').not(this).prop("checked",!1)):"toggleOrdemAZ"===e||"toggleOrdemZA"===e?selectedTitleSort="":("toggleTempoMenor"===e||"toggleTempoMaior"===e)&&(selectedTimeSort=""),filterAndSortPosts()})}function setupSearch(){$(".searchTerm").on("input",function(){searchTerm=$(this).val().toLowerCase(),filterAndSortPosts()})}function toggleSelection(e,t){let i="role"===t?selectedRoles:selectedDiets,o=i.indexOf(e);-1===o?i.push(e):i.splice(o,1)}