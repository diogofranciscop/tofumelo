let originalOrder=[],filteredPosts=[],selectedRoles=[],selectedDiets=[],selectedProtein=[],searchTerm="",selectedTitleSort="",selectedTimeSort="";window.paginationTriggered=!1,$(document).ready(function(){filteredPosts=[...originalOrder=JSON.parse(JSON.stringify(allPosts))],setupFilterButton(),setupRoleSelection(),setupDietSelection(),setupProteinSelection(),setupSorting(),setupSearch(),loadPaginatedPosts(1,filteredPosts)});let previousIsMobile=window.innerWidth<=768;function filterAndSortPosts(){filteredPosts=(filteredPosts=[...originalOrder]).filter(e=>{let t=0===selectedRoles.length||selectedRoles.some(t=>e.type.includes(t)),i=0===selectedDiets.length||selectedDiets.every(t=>e.diet.includes(t)),o=0===selectedProtein.length||selectedProtein.every(t=>e.protein.includes(t)),s=e.title.toLowerCase().includes(searchTerm);return t&&i&&s&&o}),selectedTitleSort?filteredPosts.sort((e,t)=>"toggleOrdemAZ"===selectedTitleSort?e.title.localeCompare(t.title):t.title.localeCompare(e.title)):selectedTimeSort&&filteredPosts.sort((e,t)=>"toggleTempoMenor"===selectedTimeSort?parseInt(e.time)-parseInt(t.time):parseInt(t.time)-parseInt(e.time)),loadPaginatedPosts(1,filteredPosts)}function loadPaginatedPosts(e,t){let i=window.innerWidth<=768,o=i?10:20,s=(e-1)*o,n=t.slice(s,s+o),l=$("#post-container");l.empty(),n.forEach(e=>{imagePath=e.image;let i=`
    <a href="${e.url}" class="card" data-index="${t.indexOf(e)+1}">
     <div class="skeleton skeleton-card"></div>
        <div class="card__img-container">
            <img src="${imagePath}" class="card__img" alt="${e.title}" style="display: none;">
        </div>
        ${"yes"===e.new?'<div class="new-tape" style="display:none">Nova Receita</div>':""}
        <div class="card__overlay"><p>${e.description}</p></div>
        <div class="card__footer">
            <span class="title-card" style="display: none;">${e.title.toUpperCase()}</span>
        </div>
    </a>
`;l.append(i);let o=l.find(`img[src="${imagePath}"]`);o.on("load",function(){let e=$(this).closest(".card");e.find(".skeleton-card").addClass("hidden"),$(this).fadeIn(),e.find(".title-card").removeClass("hidden").fadeIn(),e.find(".new-tape").removeClass("hidden").fadeIn()})}),updatePaginationButtons(e,t.length,o),window.paginationTriggered&&setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"}),window.paginationTriggered=!1},0)}function loadPosts(e){let t=window.innerWidth<=768,i=t?10:20,o=(e-1)*i,s=filteredPosts.slice(o,o+i),n=document.getElementById("post-container");n.innerHTML="",s.forEach(e=>{let t=`
    <a href="${e.url}" class="card">
     <div class="skeleton skeleton-card"></div> 
        ${"yes"===e.new?'<div class="new-tape">Nova Receita</div>':""}
        <div class="card__overlay"><p>${e.description}</p></div>
        <div class="card__img-container">
            <img src="${e.image}" class="card__img" alt="${e.title}">
        </div>
        <div class="card__footer">
            <span class="title-card">${e.title.toUpperCase()}</span>
        </div>
    </a>
`;n.insertAdjacentHTML("beforeend",t)}),updatePaginationButtons(e,filteredPosts.length,i)}function updatePaginationButtons(e,t,i){let o=Math.ceil(t/i),s=document.getElementById("pagination-container");s.innerHTML="";let n=document.createElement("button");n.textContent="PRIMEIRA P\xc1GINA",n.classList.add("pagination-button"),n.addEventListener("click",()=>{window.paginationTriggered=!0,loadPaginatedPosts(1,filteredPosts)}),s.appendChild(n);for(let l=Math.max(1,e-2);l<=Math.min(o,e+2);l++){let a=document.createElement("button");a.textContent=l,a.classList.add("pagination-button"),l===e&&a.classList.add("active"),a.addEventListener("click",()=>{window.paginationTriggered=!0,l!==e&&loadPaginatedPosts(l,filteredPosts)}),s.appendChild(a)}let r=document.createElement("button");r.textContent="\xdaLTIMA P\xc1GINA",r.classList.add("pagination-button"),r.addEventListener("click",()=>{window.paginationTriggered=!0,loadPaginatedPosts(o,filteredPosts)}),s.appendChild(r)}function setupFilterButton(){$(".filter-button").on("click",function(e){e.stopPropagation(),$("#filterBox").toggleClass("show-flex"),function e(t){let i=$(t).offset(),o=$(t).outerHeight();$("#filterBox").css({top:i.top+o+10+"px",left:i.left+"px",position:"absolute"})}(this)}),$(document).on("click",function(e){$(e.target).closest("#filterBox, .filter-button").length||$("#filterBox").removeClass("show-flex")})}function setupRoleSelection(){$(".button-4").on("click",function(){let e=$(this).data("role");toggleSelection(e,"role"),$(this).toggleClass("selected",selectedRoles.includes(e)),filterAndSortPosts()}),$("input[type='checkbox'][data-role]").on("change",function(){let e=$(this).data("role");toggleSelection(e,"role"),$(this).prop("checked",selectedRoles.includes(e)),filterAndSortPosts()})}function setupDietSelection(){$("#filterBox input[data-diet]").on("change",function(){let e=$(this).data("diet")||"";toggleSelection(e,"diet"),filterAndSortPosts()})}function setupProteinSelection(){$("#filterBox input[data-protein]").on("change",function(){let e=$(this).data("protein")||"";toggleSelection(e,"protein"),filterAndSortPosts()})}function setupSorting(){$('input[type="checkbox"][name="sort"]').on("change",function(){let e=$(this).attr("id");$(this).is(":checked")?(selectedTitleSort=e.startsWith("toggleOrdem")?e:"",selectedTimeSort=e.startsWith("toggleTempo")?e:"",$('input[type="checkbox"][name="sort"]').not(this).prop("checked",!1)):"toggleOrdemAZ"===e||"toggleOrdemZA"===e?selectedTitleSort="":("toggleTempoMenor"===e||"toggleTempoMaior"===e)&&(selectedTimeSort=""),filterAndSortPosts()})}function setupSearch(){$(".searchTerm").on("input",function(){searchTerm=$(this).val().toLowerCase(),filterAndSortPosts()})}function toggleSelection(e,t){let i;switch(t){case"role":i=selectedRoles;break;case"diet":i=selectedDiets;break;case"protein":i=selectedProtein;break;default:return}let o=i.indexOf(e);-1===o?i.push(e):i.splice(o,1)}