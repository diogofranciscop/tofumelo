let originalOrder=[];let filteredPosts=[];let selectedRoles=[];let selectedDiets=[];let searchTerm="";let selectedTitleSort="";let selectedTimeSort="";$(document).ready(function(){originalOrder=JSON.parse(JSON.stringify(allPosts));filteredPosts=[...originalOrder];setupFilterButton();setupRoleSelection();setupDietSelection();setupSorting();setupSearch();loadPaginatedPosts(1,filteredPosts)});window.addEventListener('resize',()=>{const isMobile=window.innerWidth<=768;const postsPerPage=isMobile?10:20;const currentPage=1;loadPaginatedPosts(currentPage,filteredPosts)});function filterAndSortPosts(){filteredPosts=[...originalOrder];filteredPosts=filteredPosts.filter(post=>{const matchesRole=selectedRoles.length===0||selectedRoles.some(role=>post.type.includes(role));const matchesDiet=selectedDiets.length===0||selectedDiets.every(diet=>post.diet.includes(diet));const matchesSearchTerm=post.title.toLowerCase().includes(searchTerm);return matchesRole&&matchesDiet&&matchesSearchTerm});if(selectedTitleSort){filteredPosts.sort((a,b)=>{return selectedTitleSort==="toggleOrdemAZ"?a.title.localeCompare(b.title):b.title.localeCompare(a.title)})}else if(selectedTimeSort){filteredPosts.sort((a,b)=>{return selectedTimeSort==="toggleTempoMenor"?parseInt(a.time)-parseInt(b.time):parseInt(b.time)-parseInt(a.time)})}loadPaginatedPosts(1,filteredPosts)}function loadPaginatedPosts(page,posts){const isMobile=window.innerWidth<=768;const postsPerPage=isMobile?10:20;const startIndex=(page-1)*postsPerPage;const endIndex=startIndex+postsPerPage;const paginatedPosts=posts.slice(startIndex,endIndex);const postContainer=$("#post-container");postContainer.empty();paginatedPosts.forEach(post=>{const imagePath=post.image.replace(/\.(webp|png|jpg|jpeg)$/,"-180px.$1");const cardHTML=`
    <a href="${post.url }" class="card" data-index="${posts.indexOf(post)+1}">
        ${post.new==="yes"?'<div class="new-tape">Nova Receita</div>':""}
        <div class="card__overlay"><p>${post.description }</p></div>
        <div class="card__img-container">
            <img src="${ imagePath }" class="card__img" alt="${post.title }">
        </div>
        <div class="card__footer">
            <span class="title-card">${post.title.toUpperCase()}</span>
        </div>
    </a>
`;postContainer.append(cardHTML)});updatePaginationButtons(page,posts.length,postsPerPage);setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},0)}function loadPosts(page){const isMobile=window.innerWidth<=768;const postsPerPage=isMobile?10:20;const startIndex=(page-1)*postsPerPage;const endIndex=startIndex+postsPerPage;const paginatedPosts=filteredPosts.slice(startIndex,endIndex);const postContainer=document.getElementById("post-container");postContainer.innerHTML="";paginatedPosts.forEach(post=>{const cardHTML=`
    <a href="${post.url }" class="card">
        ${post.new==="yes"?'<div class="new-tape">Nova Receita</div>':""}
        <div class="card__overlay"><p>${post.description }</p></div>
        <div class="card__img-container">
            <img src="${post.image }" class="card__img" alt="${post.title }">
        </div>
        <div class="card__footer">
            <span class="title-card">${post.title.toUpperCase()}</span>
        </div>
    </a>
`;postContainer.insertAdjacentHTML("beforeend",cardHTML)});updatePaginationButtons(page,filteredPosts.length,postsPerPage)}function updatePaginationButtons(currentPage,totalPosts,postsPerPage){const totalPages=Math.ceil(totalPosts/postsPerPage);const paginationContainer=document.getElementById("pagination-container");paginationContainer.innerHTML="";const firstPageButton=document.createElement("button");firstPageButton.textContent="PRIMEIRA PÁGINA";firstPageButton.classList.add("pagination-button");firstPageButton.addEventListener("click",()=>{loadPaginatedPosts(1,filteredPosts)});paginationContainer.appendChild(firstPageButton);for(let i=Math.max(1,currentPage-2);i<=Math.min(totalPages,currentPage+2);i+=1){const pageButton=document.createElement("button");pageButton.textContent=i;pageButton.classList.add("pagination-button");if(i===currentPage){pageButton.classList.add("active")}pageButton.addEventListener("click",()=>{loadPaginatedPosts(i,filteredPosts)});paginationContainer.appendChild(pageButton)}const lastPageButton=document.createElement("button");lastPageButton.textContent="ÚLTIMA PÁGINA";lastPageButton.classList.add("pagination-button");lastPageButton.addEventListener("click",()=>{loadPaginatedPosts(totalPages,filteredPosts)});paginationContainer.appendChild(lastPageButton)}function setupFilterButton(){$(".filter-button").on("click",function(event){event.stopPropagation();$("#filterBox").toggle();positionFilterBox(this)});function positionFilterBox(button){const buttonPosition=$(button).offset();const buttonHeight=$(button).outerHeight();$('#filterBox').css({top:buttonPosition.top+buttonHeight+10+'px',left:buttonPosition.left+'px',position:'absolute'})}$(document).on("click",function(event){const filterBox=$("#filterBox");const filterButton=$(".filter-button");if(!filterBox.is(event.target)&&filterBox.has(event.target).length===0&&!filterButton.is(event.target)){filterBox.hide()}})}function setupRoleSelection(){$(".button-4").on("click",function(){const role=$(this).data("role");toggleSelection(role,"role");$(this).toggleClass("selected",selectedRoles.includes(role));filterAndSortPosts()})}function setupDietSelection(){$("#filterBox input[data-diet]").on("change",function(){const diet=$(this).data("diet")||"";toggleSelection(diet,"diet");filterAndSortPosts()})}function setupSorting(){$('input[type="checkbox"][name="sort"]').on("change",function(){const id=$(this).attr("id");if(!$(this).is(":checked")){if(id==="toggleOrdemAZ"||id==="toggleOrdemZA"){selectedTitleSort=""}else if(id==="toggleTempoMenor"||id==="toggleTempoMaior"){selectedTimeSort=""}}else{selectedTitleSort=id.startsWith("toggleOrdem")?id:"";selectedTimeSort=id.startsWith("toggleTempo")?id:"";$('input[type="checkbox"][name="sort"]').not(this).prop("checked",false)}filterAndSortPosts()})}function setupSearch(){$(".searchTerm").on("input",function(){searchTerm=$(this).val().toLowerCase();filterAndSortPosts()})}function toggleSelection(value,type){const array=type==="role"?selectedRoles:selectedDiets;const index=array.indexOf(value);if(index===-1){array.push(value)}else{array.splice(index,1)}}